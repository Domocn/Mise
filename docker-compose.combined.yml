version: '3.8'

services:
  mise:
    build:
      context: .
      dockerfile: Dockerfile.combined
    container_name: mise-app
    restart: unless-stopped
    ports:
      - "3001:80"
    environment:
      - MONGO_URL=mongodb://db:27017
      - DB_NAME=mise
      - JWT_SECRET=change-me-to-a-secure-secret
      - CORS_ORIGINS=*
      - LLM_PROVIDER=embedded
    volumes:
      - mise_uploads:/app/uploads
      - mise_models:/app/models
    depends_on:
      - db

  db:
    image: mongo:7
    container_name: mise-db
    restart: unless-stopped
    volumes:
      - mise_db:/data/db

volumes:
  mise_db:
  mise_uploads:
  mise_models:
